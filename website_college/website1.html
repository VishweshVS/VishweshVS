<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campus Notes Hub</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    

    <!-- Navigation Bar -->
    <header>
        <nav class="navbar">
            <h1>Campus Notes Hub</h1>
            <img src="pics/adishankara-logo.png" alt="College Logo" class="logo">
            <img src="pics/asiet.png"  alt="College Landscape" class="Landscape">
            <ul>
                <li><a href="#">Home</a></li>
                <li><a href="http://127.0.0.1:5500/S5/website_college/upload.html">Upload</a></li>
                <li><a href="#">Browse</a></li>
                <li><a href="#">Login</a></li>
            </ul>
        </nav>
    </header>

    <!-- Search Section -->
    <section class="search-section">
        <input type="text" placeholder="Search notes...">
        <button>Search</button>
    </section>

    <!-- Notes Listing -->
    <!-- Notes Listing -->
    <section class="notes-list" id="notesList" >


        <h1>Available Notes</h1>
        <div class="note-card"></div>
        <script>
        let notes = JSON.parse(localStorage.getItem("notes")) || [];
        let container = document.getElementById("notesList");

        function base64ToBlob(base64, type) {
            const binary = atob(base64);
            const array = [];
            for (let i = 0; i < binary.length; i++) {
                array.push(binary.charCodeAt(i));
            }
            return new Blob([new Uint8Array(array)], {type: type});
        }

        if (notes.length === 0) {
            container.innerHTML = "<p>No notes uploaded yet.</p>";
        } else {
            notes.forEach((note, noteIdx) => {
                let filesHtml = "";
                if (note.files && Array.isArray(note.files)) {
                    filesHtml = note.files
                        .map((file, fileIdx) => {
                            // Try to get base64 data from sessionStorage
                            let base64 = sessionStorage.getItem(`note_${noteIdx}_file_${fileIdx}`);
                            if (base64) {
                                let blob = base64ToBlob(base64, file.type);
                                let url = URL.createObjectURL(blob);
                                return `<li>
                                    <a href="${url}" download="${file.name}">
                                        <strong>${file.name}</strong>
                                    </a>
                                    <br>Type: ${file.type || "Unknown"}
                                    <br>Size: ${(file.size / 1024).toFixed(2)} KB
                                </li>`;
                            } else {
                                return "";
                            }
                        })
                        .filter(Boolean)
                        .join("");
                    if (!filesHtml) {
                        filesHtml = "<li>No downloadable files available.</li>";
                    }
                } else {
                    filesHtml = "<li>No files found.</li>";
                }
                container.innerHTML += `
                    <div style="margin-bottom: 15px; padding: 10px; border: 1px solid black;">
                        <h3>${note.title}</h3>
                        <p>Semester: ${note.semester}</p>
                        <ul>${filesHtml}</ul>
                        <p>Uploaded by: ${note.uploader ? note.uploader : "Unknown"}</p>
                        <p>Uploaded on: ${new Date().toLocaleDateString()}</p>
                    </div>
                `;
            });
        }
    </script>
    </section>

    <!-- Footer -->
    <footer>
        <p>© 2025 Campus Notes Hub | Made with ❤️ for Our College</p>
    </footer>

</body>
</html>
